<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Rozdział 5. Dla developerów</title><link rel="stylesheet" type="text/css" href="static/aquapi.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="Komputer akwariowy AquaPi" /><link rel="up" href="index.html" title="Komputer akwariowy AquaPi" /><link rel="prev" href="hardware-dedicated.html" title="4.6. Sprzęt dedykowany do AquaPi" /><link rel="next" href="daemon.html" title="5.2. Demon" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Rozdział 5. Dla developerów</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="hardware-dedicated.html">Poprzedni</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="daemon.html">Następny</a></td></tr></table><hr /></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="devel"></a>Rozdział 5. Dla developerów</h1></div></div></div><div class="toc"><p><strong>Spis treści</strong></p><dl class="toc"><dt><span class="sect1"><a href="devel.html#database">5.1. Baza danych</a></span></dt><dt><span class="sect1"><a href="daemon.html">5.2. Demon</a></span></dt><dt><span class="sect1"><a href="i2c_dev.html">5.3. Urządzenia I2C</a></span></dt></dl></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="database"></a>5.1. Baza danych</h2></div></div></div><p>
        Ten rozdział opisuje strukturę bazy MySQL. Przedstawiono w nim schemat poszczególnych tabel.
        Opis każdej tabeli składa się z siedmiu kolumn. Znaczenie poszczególnych kolumn to:
		</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Nazwa pola</p></li><li class="listitem"><p>Typ przechowywanych danych</p></li><li class="listitem"><p>Wartość logiczna określająca, czy dane pole w tabeli może przechowywać wartość niezdefiniowaną (null).</p></li><li class="listitem"><p>Typ klucza. Może przyjmować jedną z wartości:
				</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>PRI - oznacza, że kolumna to klucz podstawowy</p></li><li class="listitem"><p>MUL - ???</p></li><li class="listitem"><p>UNI - oznacza, że wartość przechowywana w tym polu jest unikalna dla całej tabeli</p></li></ul></div></li><li class="listitem"><p>Wartość domyślna jaką przyjmie baza danych w przypadku kiedy nie zostanie podana żadna wartość. Znak myślnika oznacza, że pole nie ma zdefiniowanej domyślnej wartości.</p></li><li class="listitem"><p>Określa dodatkowe właściwości pola. Może przyjmować jedną z wartości:
				</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>auto_increment - oznacza, że kolejno dodawane rekordy będą automatycznie inkrementowane</p></li></ul></div></li><li class="listitem"><p>Dodatkowe informacje dotyczące danego pola</p></li></ol></div><p>
        Schemat bazy danych nie zawiera pól typu <code class="code">DATETIME</code>. Daty są przechowywane w formacie timestamp<a href="#ftn.timestamp" class="footnote" id="timestamp"><sup class="footnote">[1]</sup></a> w polu o typie <code class="code">INT</code>. 
    </p><div class="table"><a id="idm741"></a><p class="title"><strong>Tabela 5.1. Spis tabel</strong></p><div class="table-contents"><table class="table" summary="Spis tabel" border="1"><colgroup><col align="left" class="Nazwa" /><col align="left" class="Opis" /></colgroup><thead><tr><th align="left">Nazwa</th><th align="left">Opis</th></tr></thead><tbody><tr><td align="left">interfaces</td><td align="left">Zawiera dane interfejsów (wejść i wyjść)</td></tr><tr><td align="left">logs</td><td align="left">Zawiera logi systemowe</td></tr><tr><td align="left">settings</td><td align="left">Zawiera podstawowe ustawienia systemowe.</td></tr><tr><td align="left">stats</td><td align="left">Zawiera statystyki (dane odczytane z czujników)</td></tr><tr><td align="left">timers</td><td align="left">Zawiera spis timerów (zdarzeń)</td></tr><tr><td align="left">units</td><td align="left">Zawiera jednostki miar (używane tylko w UI)</td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="idm769"></a><p class="title"><strong>Tabela 5.2. Tabela interfaces</strong></p><div class="table-contents"><table class="table" summary="Tabela interfaces" border="1"><colgroup><col align="left" class="Pole" /><col align="left" class="Typ" /><col align="left" class="Null" /><col align="left" class="Klucz" /><col align="left" class="Domyślnie" /><col align="left" class="Ekstra" /><col align="left" class="Opis" /></colgroup><thead><tr><th align="left">Pole</th><th align="left">Typ</th><th align="left">Null</th><th align="left">Klucz</th><th align="left">Domyślnie</th><th align="left">Ekstra</th><th align="left">Opis</th></tr></thead><tbody><tr><td align="left">interface_id</td><td align="left">int(5)</td><td align="left">NO</td><td align="left">PRI</td><td align="left">NULL</td><td align="left">auto_increment</td><td align="left">Identyfikator</td></tr><tr><td align="left">interface_address</td><td align="left">varchar(200)</td><td align="left">YES</td><td align="left"> </td><td align="left">NULL</td><td align="left"> </td><td align="left">Adres interfejsu. Dla wejść może zaczynać się od:
							<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>rpi:1w: - sensory temperatury podłączone do magistrali 1wire na GPIO.</p></li><li class="listitem"><p>rpi:gpio: - pin GPIO</p></li><li class="listitem"><p>rpi:system:txtfile: - dana zostanie odczytana z pliku tekstowego</p></li><li class="listitem"><p>rpi:i2c:miniph: - dane z mostka pomiarowego Miniph</p></li><li class="listitem"><p>dummy: - sensor dummy (wirtualny) przydatny przy rozwoju aplikacji</p></li></ul></div>
							Dla wyjść może zaczynać się od:
							<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>rpi:gpio: - pin GPIO</p></li><li class="listitem"><p>rpi:system:txtfile - stan wyjścia zostanie zapisany do pliku tekstowego</p></li><li class="listitem"><p>dummy: - wyjście dummy (wirtualne) przydatne przy rozwoju aplikacji</p></li><li class="listitem"><p>relbrd: - karta przekaźników RelayBoard (wersja USB)</p></li></ul></div>
						</td></tr><tr><td align="left">interface_name</td><td align="left">varchar(30)</td><td align="left">NO</td><td align="left"> </td><td align="left">NULL</td><td align="left"> </td><td align="left">Nazwa interfejsu. Przykładowe nazwy to "oświetlenie główne", "grzałka", etc.</td></tr><tr><td align="left">interface_type</td><td align="left">tinyint(4)</td><td align="left">NO</td><td align="left"> </td><td align="left">1</td><td align="left"> </td><td align="left">Typ interfejsu. Dopuszczalne wartości to:
							<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>1 - wejście (np. sensor temperatury)</p></li><li class="listitem"><p>2 - wyjście (np. port GPIO)</p></li><li class="listitem"><p>3 - wyjście PWM (wybrane porty GPIO)</p></li></ul></div>						
						</td></tr><tr><td align="left">interface_icon</td><td align="left">varchar(20)</td><td align="left">YES</td><td align="left"> </td><td align="left">NULL</td><td align="left"> </td><td align="left">Ikonka przypisana do urządzenia</td></tr><tr><td align="left">interface_conf</td><td align="left">float</td><td align="left">YES</td><td align="left"> </td><td align="left">NULL</td><td align="left"> </td><td align="left">Negowanie sygnału wyjściowego. Możliwe ustawienia
							<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>0 - standardowe działanie</p></li><li class="listitem"><p>1 - zanegowanie wyjścia. Dla tego ustawienia "wyłączony" w AquaPi będzie oznaczało "załączony" w rzeczywistości</p></li></ul></div>							
						</td></tr><tr><td align="left">interface_deleted</td><td align="left">tinyint(4)</td><td align="left">NO</td><td align="left"> </td><td align="left">0</td><td align="left"> </td><td align="left">czy interfejs jest skasowany</td></tr><tr><td align="left">interface_htmlcolor</td><td align="left">varchar(6)</td><td align="left">YES</td><td align="left"> </td><td align="left">0</td><td align="left"> </td><td align="left">Kod HTML koloru który będzie używany na wykresie</td></tr><tr><td align="left">interface_uom</td><td align="left">int(5)</td><td align="left">YES</td><td align="left"> </td><td align="left">NULL</td><td align="left"> </td><td align="left">Id jednostki miary przypisanej do urządzenia</td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="idm893"></a><p class="title"><strong>Tabela 5.3. Tabela logs</strong></p><div class="table-contents"><table class="table" summary="Tabela logs" border="1"><colgroup><col align="left" class="Pole" /><col align="left" class="Typ" /><col align="left" class="Null" /><col align="left" class="Klucz" /><col align="left" class="Domyślnie" /><col align="left" class="Ekstra" /><col align="left" class="Opis" /></colgroup><thead><tr><th align="left">Pole</th><th align="left">Typ</th><th align="left">Null</th><th align="left">Klucz</th><th align="left">Domyślnie</th><th align="left">Ekstra</th><th align="left">Opis</th></tr></thead><tbody><tr><td align="left">log_id</td><td align="left">int(5)</td><td align="left">NO</td><td align="left">PRI</td><td align="left">NULL</td><td align="left">auto_increment</td><td align="left">Identyfikator</td></tr><tr><td align="left">log_date</td><td align="left">int(5)</td><td align="left">NO</td><td align="left"> </td><td align="left">NULL</td><td align="left"> </td><td align="left">Znacznik czasu</td></tr><tr><td align="left">log_level</td><td align="left">int(5)</td><td align="left">NO</td><td align="left"> </td><td align="left">NULL</td><td align="left"> </td><td align="left">Typ loga. Możliwe wartości to:
							<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>0 - informacja</p></li><li class="listitem"><p>1 - ostrzeżenie</p></li><li class="listitem"><p>2 - błąd krytyczny</p></li></ul></div>
						</td></tr><tr><td align="left">log_value</td><td align="left">char(200)</td><td align="left">NO</td><td align="left"> </td><td align="left">NULL</td><td align="left"> </td><td align="left">Zawartość loga</td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="idm952"></a><p class="title"><strong>Tabela 5.4. Tabela settings</strong></p><div class="table-contents"><table class="table" summary="Tabela settings" border="1"><colgroup><col align="left" class="Pole" /><col align="left" class="Typ" /><col align="left" class="Null" /><col align="left" class="Klucz" /><col align="left" class="Domyślnie" /><col align="left" class="Ekstra" /><col align="left" class="Opis" /></colgroup><thead><tr><th align="left">Pole</th><th align="left">Typ</th><th align="left">Null</th><th align="left">Klucz</th><th align="left">Domyślnie</th><th align="left">Ekstra</th><th align="left">Opis</th></tr></thead><tbody><tr><td align="left">setting_id</td><td align="left">int(5)</td><td align="left">NO</td><td align="left">PRI</td><td align="left">NULL</td><td align="left">auto_increment</td><td align="left">Identyfikator</td></tr><tr><td align="left">setting_key</td><td align="left">char(30)</td><td align="left">NO</td><td align="left"> </td><td align="left">NULL</td><td align="left"> </td><td align="left">Nazwa klucza ustawień</td></tr><tr><td align="left">setting_value</td><td align="left">char(60)</td><td align="left">NO</td><td align="left"> </td><td align="left">NULL</td><td align="left"> </td><td align="left">Wartość klucza ustawień</td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="idm996"></a><p class="title"><strong>Tabela 5.5. Tabela stats</strong></p><div class="table-contents"><table class="table" summary="Tabela stats" border="1"><colgroup><col align="left" class="Pole" /><col align="left" class="Typ" /><col align="left" class="Null" /><col align="left" class="Klucz" /><col align="left" class="Domyślnie" /><col align="left" class="Ekstra" /><col align="left" class="Opis" /></colgroup><thead><tr><th align="left">Pole</th><th align="left">Typ</th><th align="left">Null</th><th align="left">Klucz</th><th align="left">Domyślnie</th><th align="left">Ekstra</th><th align="left">Opis</th></tr></thead><tbody><tr><td align="left">stat_id</td><td align="left">int(11)</td><td align="left">NO</td><td align="left">PRI</td><td align="left">NULL</td><td align="left">auto_increment</td><td align="left">Identyfikator</td></tr><tr><td align="left">stat_date</td><td align="left">int(11)</td><td align="left">YES</td><td align="left"> </td><td align="left">NULL</td><td align="left"> </td><td align="left">Znacznik czasu</td></tr><tr><td align="left">stat_interfaceid</td><td align="left">int(5)</td><td align="left">NO</td><td align="left">MUL</td><td align="left">NULL</td><td align="left"> </td><td align="left">Identyfikator interfejsu którego dotyczy zachowana wartość</td></tr><tr><td align="left">stat_value</td><td align="left">float</td><td align="left">NO</td><td align="left"> </td><td align="left">NULL</td><td align="left"> </td><td align="left">Wartość odczytana z interfejsu</td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="idm1048"></a><p class="title"><strong>Tabela 5.6. Tabela timers</strong></p><div class="table-contents"><table class="table" summary="Tabela timers" border="1"><colgroup><col align="left" class="Pole" /><col align="left" class="Typ" /><col align="left" class="Null" /><col align="left" class="Klucz" /><col align="left" class="Domyślnie" /><col align="left" class="Ekstra" /><col align="left" class="Opis" /></colgroup><thead><tr><th align="left">Pole</th><th align="left">Typ</th><th align="left">Null</th><th align="left">Klucz</th><th align="left">Domyślnie</th><th align="left">Ekstra</th><th align="left">Opis</th></tr></thead><tbody><tr><td align="left">timer_id</td><td align="left">int(5)</td><td align="left">NO</td><td align="left">PRI</td><td align="left">NULL</td><td align="left">auto_increment</td><td align="left">Identyfikator</td></tr><tr><td align="left">timer_timeif</td><td align="left">int(5)</td><td align="left">YES</td><td align="left"> </td><td align="left">NULL</td><td align="left"> </td><td align="left">Uproszczony znacznik czasu informujący kiedy timer ma być aktywny. W odróżnieniu od zwykłego znacznika, ten zawiera liczbę sekund która upłyneła od północy.</td></tr><tr><td align="left">timer_action</td><td align="left">tinyint(4)</td><td align="left">NO</td><td align="left"> </td><td align="left">NULL</td><td align="left"> </td><td align="left">Nowa wartość dla interfejsu przełączanego. 0 - wyłacz, 1-włacz</td></tr><tr><td align="left">timer_interfaceidthen</td><td align="left">int(5)</td><td align="left">NO</td><td align="left">MUL</td><td align="left">NULL</td><td align="left"> </td><td align="left">Identyfikator interfejsu który ma być przyłączony jeśli warunki zdarzenia są spełnione</td></tr><tr><td align="left">timer_days</td><td align="left">varchar(7)</td><td align="left">NO</td><td align="left"> </td><td align="left">NULL</td><td align="left"> </td><td align="left">Dni tygodnia w kórych timer powinien być sprawdzany. Dni są zapisane jako ciąg zer i jedynek. Od lewej strony zaczynając dni to: niedziela, poniedziałek, wtorek, środa, czwartek, piątek, sobota.</td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="idm1108"></a><p class="title"><strong>Tabela 5.7. Tabela units</strong></p><div class="table-contents"><table class="table" summary="Tabela units" border="1"><colgroup><col align="left" class="Pole" /><col align="left" class="Typ" /><col align="left" class="Null" /><col align="left" class="Klucz" /><col align="left" class="Domyślnie" /><col align="left" class="Ekstra" /><col align="left" class="Opis" /></colgroup><thead><tr><th align="left">Pole</th><th align="left">Typ</th><th align="left">Null</th><th align="left">Klucz</th><th align="left">Domyślnie</th><th align="left">Ekstra</th><th align="left">Opis</th></tr></thead><tbody><tr><td align="left">unit_id</td><td align="left">int(11)</td><td align="left">NO</td><td align="left">PRI</td><td align="left">NULL</td><td align="left">auto_increment</td><td align="left">Identyfikator</td></tr><tr><td align="left">unit_name</td><td align="left">varchar(32)</td><td align="left">NO</td><td align="left"> </td><td align="left">NULL</td><td align="left"> </td><td align="left">Jednostka miary</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="footnotes"><br /><hr style="width:100; text-align:left;margin-left: 0" /><div id="ftn.timestamp" class="footnote"><p><a href="#timestamp" class="para"><sup class="para">[1] </sup></a>
        Przechowywanie daty w formacie timestamp polega na zapisaniu liczby sekund
        od daty 1/01/1970, czyli od momentu początku epoki unixa.
    </p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="hardware-dedicated.html">Poprzedni</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="daemon.html">Następny</a></td></tr><tr><td width="40%" align="left" valign="top">4.6. Sprzęt dedykowany do AquaPi </td><td width="20%" align="center"><a accesskey="h" href="index.html">Spis treści</a></td><td width="40%" align="right" valign="top"> 5.2. Demon</td></tr></table></div></body></html>